# VG Security Override: Modsecurity/CRS Configuration Only
#
# This file contains ONLY security-related configurations (modsecurity, CRS, networks).
# For development overrides (live reload, etc.), see docker-compose.dev-overrides.yml
#
# Usage:
#   Production:  docker compose up
#   Development: docker compose -f docker-compose.yml -f docker-compose.override.yml -f docker-compose.dev.yml up

services:
  nginx:
    build:
      args:
        NGINX_BASE_IMAGE: ${NGINX_BASE_IMAGE:-drguptavivek/central-nginx-vg-base:6.0.1}
    volumes:
      # Modsecurity CRS configs
      - ./crs/crs-setup.conf.example:/etc/modsecurity/crs/crs-setup.conf:ro
      - ./crs/rules:/etc/modsecurity/crs/rules:ro
      - ./crs_custom:/etc/modsecurity/custom:ro
      # Security logging
      - ./logs/nginx:/var/log/nginx
      - ./logs/modsecurity:/var/log/modsecurity
    networks:
      - default
      - web

  service:
    networks:
      - default
      - db_net
      - web

  postgres14:
    networks:
      - default
      - db_net

networks:
  db_net:
    external: true
  web:
    external: true

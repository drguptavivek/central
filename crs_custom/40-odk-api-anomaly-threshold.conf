# ODK Central API (JSON) false-positive mitigation
#
# Some authenticated Central web UI operations (e.g. PATCH) can accumulate CRS
# anomaly score >= default threshold and be blocked by rule 949110.
#
# Raise the inbound anomaly threshold for Central API requests. Central's API
# surface is primarily authenticated; this avoids frequent false-positive blocks
# (rule 949110) during normal UI operations while still logging detections.
SecRule REQUEST_URI "@rx ^/v\\d+/" \
  "id:1000401,phase:1,pass,nolog,setvar:tx.inbound_anomaly_score_threshold=20"

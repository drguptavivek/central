# ODK Central API (JSON) false-positive mitigation
#
# Some authenticated Central web UI operations (e.g. PATCH) can accumulate CRS
# anomaly score >= default threshold and be blocked by rule 949110.
#
# Raise the inbound anomaly threshold only for authenticated API requests, so
# the WAF still blocks unauthenticated probes and continues logging detections.
SecRule REQUEST_URI "@rx ^/v\\d+/" "id:1000401,phase:1,pass,nolog,chain"
  SecRule REQUEST_HEADERS:Cookie "@rx (__Host-session=|__csrf=)" \
    "setvar:tx.inbound_anomaly_score_threshold=20"


# ODK Central OData endpoints (Submissions)
#
# Central uses OData-style query params like `$filter`, `$orderby`, `$top`, etc.
# CRS can false-positive these (e.g. $filter flagged as SQLi keyword).
#
# We keep this scoped to `.svc/` endpoints and only for requests that appear to
# have Central session cookies, to avoid over-broad exclusions.
SecRule REQUEST_METHOD "@streq GET" "id:1000201,phase:1,pass,nolog,chain"
  SecRule REQUEST_URI "@rx \.svc/(?:Submissions|Entities)(?:$|\?)" "chain"
    SecRule REQUEST_HEADERS:Cookie "@rx (__Host-session=|__csrf=)" \
      "ctl:ruleRemoveById=942290,ctl:ruleRemoveById=920100"

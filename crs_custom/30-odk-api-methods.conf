# ODK Central uses REST methods beyond CRS defaults (GET/HEAD/POST/OPTIONS),
# including PUT/PATCH/DELETE on the JSON API under /v1/.
#
# CRS rule 911100 (REQUEST-911-METHOD-ENFORCEMENT) blocks these methods by
# default. Disable it only for the Central API surface.
#
# Guard further by requiring Central session-related cookies. This does not
# prove authentication, but it avoids disabling method enforcement for totally
# unauthenticated traffic.
SecRule REQUEST_URI "@rx ^/v1/" \
  "id:1000003,phase:1,pass,nolog,chain"
  SecRule REQUEST_HEADERS:Cookie "@rx (?:^|;\\s*)(?:__Host-session=|__csrf=)" \
    "t:none,ctl:ruleRemoveById=911100"
